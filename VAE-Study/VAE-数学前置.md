### 生成模型
==本质==：对样本X的概率分布P(X)做估计：即预测什么样的样本出现的概率高，什么样的样本出现的概率低
![[b1596590-e8f3-4b86-b20b-2647f033a82a.png]]



---
## 自回归模型

### 1.考虑如何在概率密度上进行建模？
![[3a59655e-0b71-402d-acc5-cbaa2215faeb.png]]
#### 难点1
在求极大似然参数估计的时候，尤其是进行反向传播时，由于$p(x,y)$和$log$之间有积分符号，因此**不好求导**。
#### 难点2
假设有n个样本的样本集$X$，我们对它进行序列化建模
$$X=\left(x_1,x_2,x_3...x_n\right)$$
对于这样一个可以进行序列化的(**结构化的数据**（如图像、文本、数组）),我们要考虑，这种数据有一个特点：==非独立同分布==。因此，要清楚的对每一个样本进行建模，我们需要条件概率密度来表达。$$P\left(x_1,x_2,x_3...x_n\right)=P\left(x_1\right)P\left(x_2|x_1)..P(x_n|x_1,...,x_n-1\right)$$
- 需要注意：对每一个条件概率做好归一化：
			$$\int P\left(x_i|x_1,x_2...x_n\right)=1$$
- 在DNN中，一般由softmax 进行归一化处理

### 难点 for images dataset  
那么很明显对于这种序列型数据来说，如果只是语言文本token其实还可以，但是对于图像数据来说，我们将其展开为一维的，那么带来的计算量是非常大的

## 对于VAE的数学补充
---
### 1.极大似然估计
我的理解： 假设存在一个事实，在这个事实下，我们所有采样的样本表现出了一个分布。但是这个分布的出现也是偶然的，因此我们假设存在一些参数$\theta$，能够表达出这个分布。我们将这些参数设为条件概率的条件，然后重新采样，让所有样本同时发生的概率最大，以此来寻找这些参数
![[Pasted image 20250923211728.png]]
![[850a0512-7e0a-4ae3-aaf9-8f7b2771e816.png]]

---
### 2.蒙特卡洛
**实质：随机抽样**
1.为什么抽样？
为了统计推断 得到一个总体分布
我们在得到一个概率分布时，如果要基于这个样本空间求解求解更复杂的样本空间分布：比如说X对应到$X^2$的这样一个操作，那么此时可能无法积分。这个时候我们通常对累积分布函数进行随机抽样，累积分布函数很简单就是那个左下原则的对PDF进行积分的公式，求完以后对累积分布函数求逆函数，然后获得$X^2$
 ==但是又有有一个问题，这个累积分布积分也不好求怎么办？==
 ![[e4dfd37f-7914-4bab-b663-8955e589c076.png]]
## 探针方法 
2.这个方法其实和那个撒针来估计$\pai$的问题思路一致了
针对一些复杂分布函数，我们考虑用另外一个分布去逼近它，如下图
![[183a1486-1618-4c00-89f8-4707490c2bcb.png]]
**此外要注意一点**：如果我们仅仅按照“**只要比值不为0就接受**”的规则接受所有样本，那么**可能会接受一些概率非常低的样本**，即使这些样本不太符合目标分布 f(x)，这会导致生成样本的质量下降，最终使得样本集的分布偏离目标分布。

### 关键2  这里的u(0,1)是另外一个分布
我们已经确定好了 接受概率 那么应该如何去模拟这个采样过程？

1. **均匀分布的随机性**确保了每个样本的采样过程是**公平的**，并且符合概率控制的要求。
2. **接受概率** ppp = 0.9 是我们期望样本被接受的**概率**，我们希望大约 90% 的样本被接受，10% 的样本被拒绝。
### 如何确保模拟 90% 的接受概率？
#### 步骤 1：生成均匀分布的随机数
首先，我们从均匀分布 U(0,1) 中生成 100 个随机数 i1,i2,…,i100i_1, i_2, \dots, i_{100}i1​,i2​,…,i100​，这些随机数是独立的，并且**每个随机数都有相同的概率**在区间 [0, 1] 中落在任何位置。
#### 步骤 2：设定接受概率 p=0.9p = 0.9p=0.9
接下来，我们设定**接受概率** p=0.9，意味着我们希望样本**有 90% 的概率被接受**。
#### 步骤 3：与接受概率进行比较
对每个随机数 iki_kik​，我们通过比较它与接受概率 ppp 来决定是否接受该样本：
- 如果 ik≤p=0.9i_k \leq p = 0.9ik​≤p=0.9，则**接受**这个样本。
    
- 如果 ik>pi_k > pik​>p，则**拒绝**这个样本。
#### 步骤 4：统计结果
由于 iki_kik​ 是从均匀分布 U(0,1)U(0, 1)U(0,1) 中采样的，因此：
- 大约 **90% 的样本**（即 90 次）会落在 [0,0.9][0, 0.9][0,0.9] 区间内，满足 ik≤0.9i_k \leq 0.9ik​≤0.9，这些样本会被接受；
- 大约 **10% 的样本**（即 10 次）会落在 (0.9,1](0.9, 1](0.9,1] 区间内，满足 ik>0.9i_k > 0.9ik​>0.9，这些样本会被拒绝。
### 为什么均匀分布 U(0,1能确保这一点？

均匀分布 U(0,1)的核心特性是：在区间 [0, 1] 内**每个值出现的概率相等**，即它是**等概率分布**的。通过从 U(0,1) 中抽取 100 个值，我们能够确保这些值在整个区间内是随机分布的，因此：

- 在 100 次采样中，**大约 90 次** iki_kik​ 会小于或等于 0.9（即 ik≤0.9i_k \leq 0.9ik​≤0.9），这些样本将被接受；
    
- **大约 10 次** iki_kik​ 会大于 0.9（即 ik>0.9i_k > 0.9ik​>0.9），这些样本将被拒绝。
### 总结：

- **均匀分布的作用**是确保**每个随机数的生成是等概率的**，即在 [0, 1] 区间内任何位置的数值都可能被生成。通过生成这些随机数并与接受概率 p=0.9p = 0.9p=0.9 比较，我们能够确保大约 90% 的样本被接受，10% 的样本被拒绝。
    
- **为什么随机性与接受概率结合**：通过均匀分布生成的随机数 iki_kik​，确保了样本被接受的概率 p=0.9p = 0.9p=0.9 是准确的。每次比较时，**只要 iki_kik​ 小于 ppp**，就接受这个样本。这使得我们能够保证在 100 次采样中，大约 90 次样本会被接受。
    

所以，**均匀分布的随机性**使得我们能够模拟“按照 p概率接受样本”的过程，确保**90% 接受概率**的目标。

---
![[9c22e942-f39c-4adb-959b-cddcd2b8b715.png]]

---
![[a86982bd-cd52-405a-81fc-d1e5aeb63911.png]]

---
![[a272c250-a227-47a8-84db-c385cb8d9d10.png]]
![[a5f44e71-cbff-4308-9202-d69797f3b12b.png]]

---
![[57487cb8-5ed8-4d78-928b-65bbef2e364d.png]]

---
### Jensen 不等式
![[Pasted image 20250924145038.png]]
意思就是说 如果F是一个凸函数 那么对于这个凸函数和随机变量X的不等式，把期望值视为t。那么根据Jensen不等式，我直接计算期望值带入到凸函数中得到的函数值是小于或者等于将这个期望值作为权重乘以随机变量的凸函数值。


==对于 **凹函数**（如 **对数函数** log⁡(x)），Jensen不等式的结论确实会发生变化==
![[Pasted image 20250924150302.png]]

---
### 变分
![[Pasted image 20250924150640.png]]
example:输入一个PDF，得到一个混乱度
example:loss_function
![[Pasted image 20250924151301.png]]
